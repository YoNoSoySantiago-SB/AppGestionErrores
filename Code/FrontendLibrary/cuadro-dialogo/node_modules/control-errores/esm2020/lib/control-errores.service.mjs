import { Injectable, } from '@angular/core';
import { HttpErrorResponse, } from '@angular/common/http';
import * as i0 from "@angular/core";
/**
 * Trata de desempaquetar un error, verificando si tiene la propiedad de angular ngOriginalError, la cual crea una copia del error antes de ser manipulado.
 *
 * @param error El error a desempaquetar.
 * @return Si el error tiene la propiedad ngOriginalError, devuelve el valor de dicha propiedad; de lo contrario, devuelve el error original.
 */
function tryToUnwrapZonejsError(error) {
    return error && error.ngOriginalError
        ? error.ngOriginalError
        : error;
}
/**
 * Extrae información del error de una respuesta HTTP.
 *
 * @param error La respuesta HTTP.
 * @return Si el error es un objeto que cumple con la interfaz Error, devuelve el objeto; si es un evento de error y tiene un mensaje, devuelve el mensaje; si es una cadena, devuelve una cadena que indica el código de estado y el cuerpo de la respuesta; de lo contrario, devuelve el error original.
 */
function extraerHttpErrro(error) {
    if (EsErrorOErrorObjeto(error.error)) {
        return error.error;
    }
    if (error.error instanceof ErrorEvent && error.error.message) {
        return error.error.message;
    }
    if (typeof error.error === 'string') {
        return `Servidor retorno el codigo  ${error.status} con cuerpo "${error.error}"`;
    }
    return error;
}
/**
 * Comprueba si un valor es un objeto de tipo Error o no.
 *
 * @param value El valor a comprobar.
 * @return True si el valor es un objeto de tipo Error, False en caso contrario.
 */
function EsErrorOErrorObjeto(value) {
    if (value instanceof Error) {
        return true;
    }
    if (value === null || typeof value !== 'object') {
        return false;
    }
    const candidate = value;
    return (typeof candidate.name === 'string' &&
        typeof candidate.name === 'string' &&
        typeof candidate.message === 'string' &&
        (undefined === candidate.stack || typeof candidate.stack === 'string'));
}
/**
 * Crea un objeto que contiene información sobre un error, incluido el mensaje de error y el callstack.
 *
 * @param error El error a analizar.
 * @return Un objeto que contiene el mensaje de error y el callstack del error.
 */
export function crearMensajeObjeto(error) {
    //Obtiene los stack del error
    const stack = error.stack;
    if (!stack) {
    }
    const lines = stack.split('\n');
    const methodRegex = /at (.*) \((.*):(\d+):(\d+)\)/;
    //Los separa por linea a cada error
    let lineasAt = '';
    lines.forEach((line) => {
        lineasAt += line;
    });
    //retorna el mensaje del error y el callstack
    const errorInfo = {
        message: error.toString(),
        method: lineasAt,
    };
    return errorInfo;
}
/**
 * Esta clase implementa la interfaz ErrorHandler y se encarga de manejar los errores que se producen
 * en la aplicación. Proporciona una función para extraer información sobre el error y generar un mensaje
 * de error para mostrar al usuario.
 */
export class ControlErroresService {
    /**
     * Constructor de la clase ControlErroresService.
     */
    constructor() { }
    /**
     * Esta función se encarga de manejar los errores que se producen en la aplicación.
     * Si el error no es una HttpErrorResponse, extrae información sobre el error y genera un mensaje
     * de error utilizando la función crearMensajeObjeto(). Si es una HttpErrorResponse, extrae información
     * sobre el error utilizando la función extraerHttpErrro() y devuelve un mensaje de error vacío.
     *
     * @param error El error que se ha producido.
     * @returns Una tupla que contiene información sobre el error y un mensaje de error para mostrar al usuario.
     */
    handleError(error) {
        if (!(error instanceof HttpErrorResponse)) {
            return [this.extractorErrorTipo(error), crearMensajeObjeto(error)];
        }
        else {
            return [this.extractorErrorTipo(error), ''];
        }
    }
    /**
     * Esta función se encarga de extraer información sobre el error dependiendo del tipo que sea.
     * Si el error es una HttpErrorResponse, utiliza la función extraerHttpErrro() para extraer información
     * sobre el error. Si el error es una cadena o un objeto de error, simplemente devuelve el error tal cual.
     *
     * @param errorCandidate El error del que se quiere extraer información.
     * @returns La información extraída del error.
     */
    extractorErrorTipo(errorCandidate) {
        const error = tryToUnwrapZonejsError(errorCandidate);
        if (error instanceof HttpErrorResponse) {
            return extraerHttpErrro(error);
        }
        if (typeof error === 'string' || EsErrorOErrorObjeto(error)) {
            return error;
        }
        // No extrae nada, devuelve el error por defecto
        return null;
    }
}
ControlErroresService.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: ControlErroresService, deps: [], target: i0.ɵɵFactoryTarget.Injectable });
ControlErroresService.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: ControlErroresService, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "14.2.12", ngImport: i0, type: ControlErroresService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root',
                }]
        }], ctorParameters: function () { return []; } });
export function createError(config) {
    return new ControlErroresService();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udHJvbC1lcnJvcmVzLnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9jb250cm9sLWVycm9yZXMvc3JjL2xpYi9jb250cm9sLWVycm9yZXMuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBS0wsVUFBVSxHQU1YLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFDTCxpQkFBaUIsR0FHbEIsTUFBTSxzQkFBc0IsQ0FBQzs7QUFFOUI7Ozs7O0dBS0c7QUFDSCxTQUFTLHNCQUFzQixDQUFDLEtBQWM7SUFDNUMsT0FBTyxLQUFLLElBQUssS0FBb0MsQ0FBQyxlQUFlO1FBQ25FLENBQUMsQ0FBRSxLQUFvQyxDQUFDLGVBQWU7UUFDdkQsQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUNaLENBQUM7QUFFRDs7Ozs7R0FLRztBQUNILFNBQVMsZ0JBQWdCLENBQUMsS0FBd0I7SUFDaEQsSUFBSSxtQkFBbUIsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDcEMsT0FBTyxLQUFLLENBQUMsS0FBSyxDQUFDO0tBQ3BCO0lBRUQsSUFBSSxLQUFLLENBQUMsS0FBSyxZQUFZLFVBQVUsSUFBSSxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRTtRQUM1RCxPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDO0tBQzVCO0lBQ0QsSUFBSSxPQUFPLEtBQUssQ0FBQyxLQUFLLEtBQUssUUFBUSxFQUFFO1FBQ25DLE9BQU8sK0JBQStCLEtBQUssQ0FBQyxNQUFNLGdCQUFnQixLQUFLLENBQUMsS0FBSyxHQUFHLENBQUM7S0FDbEY7SUFFRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUM7QUFPRDs7Ozs7R0FLRztBQUNILFNBQVMsbUJBQW1CLENBQUMsS0FBYztJQUN6QyxJQUFJLEtBQUssWUFBWSxLQUFLLEVBQUU7UUFDMUIsT0FBTyxJQUFJLENBQUM7S0FDYjtJQUVELElBQUksS0FBSyxLQUFLLElBQUksSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLEVBQUU7UUFDL0MsT0FBTyxLQUFLLENBQUM7S0FDZDtJQUVELE1BQU0sU0FBUyxHQUFHLEtBQXVCLENBQUM7SUFFMUMsT0FBTyxDQUNMLE9BQU8sU0FBUyxDQUFDLElBQUksS0FBSyxRQUFRO1FBQ2xDLE9BQU8sU0FBUyxDQUFDLElBQUksS0FBSyxRQUFRO1FBQ2xDLE9BQU8sU0FBUyxDQUFDLE9BQU8sS0FBSyxRQUFRO1FBQ3JDLENBQUMsU0FBUyxLQUFLLFNBQVMsQ0FBQyxLQUFLLElBQUksT0FBTyxTQUFTLENBQUMsS0FBSyxLQUFLLFFBQVEsQ0FBQyxDQUN2RSxDQUFDO0FBQ0osQ0FBQztBQUNEOzs7OztHQUtHO0FBQ0gsTUFBTSxVQUFVLGtCQUFrQixDQUFDLEtBQVk7SUFDN0MsNkJBQTZCO0lBQzdCLE1BQU0sS0FBSyxHQUFRLEtBQUssQ0FBQyxLQUFLLENBQUM7SUFDL0IsSUFBSSxDQUFDLEtBQUssRUFBRTtLQUNYO0lBQ0QsTUFBTSxLQUFLLEdBQWEsS0FBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUUxQyxNQUFNLFdBQVcsR0FBUSw4QkFBOEIsQ0FBQztJQUN4RCxtQ0FBbUM7SUFDbkMsSUFBSSxRQUFRLEdBQVcsRUFBRSxDQUFDO0lBQzFCLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtRQUNyQixRQUFRLElBQUksSUFBSSxDQUFDO0lBQ25CLENBQUMsQ0FBQyxDQUFDO0lBQ0gsNkNBQTZDO0lBQzdDLE1BQU0sU0FBUyxHQUFjO1FBQzNCLE9BQU8sRUFBRSxLQUFLLENBQUMsUUFBUSxFQUFFO1FBQ3pCLE1BQU0sRUFBRSxRQUFRO0tBQ2pCLENBQUM7SUFFRixPQUFPLFNBQVMsQ0FBQztBQUNuQixDQUFDO0FBRUQ7Ozs7R0FJRztBQUlILE1BQU0sT0FBTyxxQkFBcUI7SUFDaEM7O09BRUc7SUFDSCxnQkFBZSxDQUFDO0lBRWhCOzs7Ozs7OztPQVFHO0lBQ0gsV0FBVyxDQUFDLEtBQVk7UUFDdEIsSUFBSSxDQUFDLENBQUMsS0FBSyxZQUFZLGlCQUFpQixDQUFDLEVBQUU7WUFDekMsT0FBTyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsRUFBRSxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1NBQ3BFO2FBQU07WUFDTCxPQUFPLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQzdDO0lBQ0gsQ0FBQztJQUVEOzs7Ozs7O09BT0c7SUFDTyxrQkFBa0IsQ0FBQyxjQUF1QjtRQUNsRCxNQUFNLEtBQUssR0FBRyxzQkFBc0IsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUVyRCxJQUFJLEtBQUssWUFBWSxpQkFBaUIsRUFBRTtZQUN0QyxPQUFPLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ2hDO1FBRUQsSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLElBQUksbUJBQW1CLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDM0QsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUVELGdEQUFnRDtRQUNoRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7O21IQTVDVSxxQkFBcUI7dUhBQXJCLHFCQUFxQixjQUZwQixNQUFNOzRGQUVQLHFCQUFxQjtrQkFIakMsVUFBVTttQkFBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkI7O0FBZ0RELE1BQU0sVUFBVSxXQUFXLENBQUMsTUFBYztJQUN4QyxPQUFPLElBQUkscUJBQXFCLEVBQUUsQ0FBQztBQUNyQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBFcnJvckhhbmRsZXIsXG4gIENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcbiAgVmlld0NvbnRhaW5lclJlZixcbiAgSW5qZWN0YWJsZSxcbiAgVmlld0NoaWxkLFxuICBJbmplY3RvcixcbiAgUmVmbGVjdGl2ZUluamVjdG9yLFxuICBEaXJlY3RpdmUsXG4gIEluamVjdCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBlcnJvckluZm8sIG1ldG9kb3MgfSBmcm9tICcuL2ludGVyZmF6JztcbmltcG9ydCB7XG4gIEh0dHBFcnJvclJlc3BvbnNlLFxuICBIdHRwQ2xpZW50LFxuICBIdHRwSGFuZGxlcixcbn0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuXG4vKipcbiAqIFRyYXRhIGRlIGRlc2VtcGFxdWV0YXIgdW4gZXJyb3IsIHZlcmlmaWNhbmRvIHNpIHRpZW5lIGxhIHByb3BpZWRhZCBkZSBhbmd1bGFyIG5nT3JpZ2luYWxFcnJvciwgbGEgY3VhbCBjcmVhIHVuYSBjb3BpYSBkZWwgZXJyb3IgYW50ZXMgZGUgc2VyIG1hbmlwdWxhZG8uXG4gKlxuICogQHBhcmFtIGVycm9yIEVsIGVycm9yIGEgZGVzZW1wYXF1ZXRhci5cbiAqIEByZXR1cm4gU2kgZWwgZXJyb3IgdGllbmUgbGEgcHJvcGllZGFkIG5nT3JpZ2luYWxFcnJvciwgZGV2dWVsdmUgZWwgdmFsb3IgZGUgZGljaGEgcHJvcGllZGFkOyBkZSBsbyBjb250cmFyaW8sIGRldnVlbHZlIGVsIGVycm9yIG9yaWdpbmFsLlxuICovXG5mdW5jdGlvbiB0cnlUb1Vud3JhcFpvbmVqc0Vycm9yKGVycm9yOiB1bmtub3duKTogdW5rbm93biB8IEVycm9yIHtcbiAgcmV0dXJuIGVycm9yICYmIChlcnJvciBhcyB7IG5nT3JpZ2luYWxFcnJvcjogRXJyb3IgfSkubmdPcmlnaW5hbEVycm9yXG4gICAgPyAoZXJyb3IgYXMgeyBuZ09yaWdpbmFsRXJyb3I6IEVycm9yIH0pLm5nT3JpZ2luYWxFcnJvclxuICAgIDogZXJyb3I7XG59XG5cbi8qKlxuICogRXh0cmFlIGluZm9ybWFjacOzbiBkZWwgZXJyb3IgZGUgdW5hIHJlc3B1ZXN0YSBIVFRQLlxuICpcbiAqIEBwYXJhbSBlcnJvciBMYSByZXNwdWVzdGEgSFRUUC5cbiAqIEByZXR1cm4gU2kgZWwgZXJyb3IgZXMgdW4gb2JqZXRvIHF1ZSBjdW1wbGUgY29uIGxhIGludGVyZmF6IEVycm9yLCBkZXZ1ZWx2ZSBlbCBvYmpldG87IHNpIGVzIHVuIGV2ZW50byBkZSBlcnJvciB5IHRpZW5lIHVuIG1lbnNhamUsIGRldnVlbHZlIGVsIG1lbnNhamU7IHNpIGVzIHVuYSBjYWRlbmEsIGRldnVlbHZlIHVuYSBjYWRlbmEgcXVlIGluZGljYSBlbCBjw7NkaWdvIGRlIGVzdGFkbyB5IGVsIGN1ZXJwbyBkZSBsYSByZXNwdWVzdGE7IGRlIGxvIGNvbnRyYXJpbywgZGV2dWVsdmUgZWwgZXJyb3Igb3JpZ2luYWwuXG4gKi9cbmZ1bmN0aW9uIGV4dHJhZXJIdHRwRXJycm8oZXJyb3I6IEh0dHBFcnJvclJlc3BvbnNlKTogc3RyaW5nIHwgRXJyb3Ige1xuICBpZiAoRXNFcnJvck9FcnJvck9iamV0byhlcnJvci5lcnJvcikpIHtcbiAgICByZXR1cm4gZXJyb3IuZXJyb3I7XG4gIH1cblxuICBpZiAoZXJyb3IuZXJyb3IgaW5zdGFuY2VvZiBFcnJvckV2ZW50ICYmIGVycm9yLmVycm9yLm1lc3NhZ2UpIHtcbiAgICByZXR1cm4gZXJyb3IuZXJyb3IubWVzc2FnZTtcbiAgfVxuICBpZiAodHlwZW9mIGVycm9yLmVycm9yID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBgU2Vydmlkb3IgcmV0b3JubyBlbCBjb2RpZ28gICR7ZXJyb3Iuc3RhdHVzfSBjb24gY3VlcnBvIFwiJHtlcnJvci5lcnJvcn1cImA7XG4gIH1cblxuICByZXR1cm4gZXJyb3I7XG59XG5cbnR5cGUgRXJyb3JDYW5kaWRhdGUgPSB7XG4gIG5hbWU/OiB1bmtub3duO1xuICBtZXNzYWdlPzogdW5rbm93bjtcbiAgc3RhY2s/OiB1bmtub3duO1xufTtcbi8qKlxuICogQ29tcHJ1ZWJhIHNpIHVuIHZhbG9yIGVzIHVuIG9iamV0byBkZSB0aXBvIEVycm9yIG8gbm8uXG4gKlxuICogQHBhcmFtIHZhbHVlIEVsIHZhbG9yIGEgY29tcHJvYmFyLlxuICogQHJldHVybiBUcnVlIHNpIGVsIHZhbG9yIGVzIHVuIG9iamV0byBkZSB0aXBvIEVycm9yLCBGYWxzZSBlbiBjYXNvIGNvbnRyYXJpby5cbiAqL1xuZnVuY3Rpb24gRXNFcnJvck9FcnJvck9iamV0byh2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIEVycm9yIHtcbiAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgIT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgY29uc3QgY2FuZGlkYXRlID0gdmFsdWUgYXMgRXJyb3JDYW5kaWRhdGU7XG5cbiAgcmV0dXJuIChcbiAgICB0eXBlb2YgY2FuZGlkYXRlLm5hbWUgPT09ICdzdHJpbmcnICYmXG4gICAgdHlwZW9mIGNhbmRpZGF0ZS5uYW1lID09PSAnc3RyaW5nJyAmJlxuICAgIHR5cGVvZiBjYW5kaWRhdGUubWVzc2FnZSA9PT0gJ3N0cmluZycgJiZcbiAgICAodW5kZWZpbmVkID09PSBjYW5kaWRhdGUuc3RhY2sgfHwgdHlwZW9mIGNhbmRpZGF0ZS5zdGFjayA9PT0gJ3N0cmluZycpXG4gICk7XG59XG4vKipcbiAqIENyZWEgdW4gb2JqZXRvIHF1ZSBjb250aWVuZSBpbmZvcm1hY2nDs24gc29icmUgdW4gZXJyb3IsIGluY2x1aWRvIGVsIG1lbnNhamUgZGUgZXJyb3IgeSBlbCBjYWxsc3RhY2suXG4gKlxuICogQHBhcmFtIGVycm9yIEVsIGVycm9yIGEgYW5hbGl6YXIuXG4gKiBAcmV0dXJuIFVuIG9iamV0byBxdWUgY29udGllbmUgZWwgbWVuc2FqZSBkZSBlcnJvciB5IGVsIGNhbGxzdGFjayBkZWwgZXJyb3IuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhck1lbnNhamVPYmpldG8oZXJyb3I6IEVycm9yKSB7XG4gIC8vT2J0aWVuZSBsb3Mgc3RhY2sgZGVsIGVycm9yXG4gIGNvbnN0IHN0YWNrOiBhbnkgPSBlcnJvci5zdGFjaztcbiAgaWYgKCFzdGFjaykge1xuICB9XG4gIGNvbnN0IGxpbmVzOiBzdHJpbmdbXSA9IHN0YWNrLnNwbGl0KCdcXG4nKTtcblxuICBjb25zdCBtZXRob2RSZWdleDogYW55ID0gL2F0ICguKikgXFwoKC4qKTooXFxkKyk6KFxcZCspXFwpLztcbiAgLy9Mb3Mgc2VwYXJhIHBvciBsaW5lYSBhIGNhZGEgZXJyb3JcbiAgbGV0IGxpbmVhc0F0OiBzdHJpbmcgPSAnJztcbiAgbGluZXMuZm9yRWFjaCgobGluZSkgPT4ge1xuICAgIGxpbmVhc0F0ICs9IGxpbmU7XG4gIH0pO1xuICAvL3JldG9ybmEgZWwgbWVuc2FqZSBkZWwgZXJyb3IgeSBlbCBjYWxsc3RhY2tcbiAgY29uc3QgZXJyb3JJbmZvOiBlcnJvckluZm8gPSB7XG4gICAgbWVzc2FnZTogZXJyb3IudG9TdHJpbmcoKSxcbiAgICBtZXRob2Q6IGxpbmVhc0F0LFxuICB9O1xuXG4gIHJldHVybiBlcnJvckluZm87XG59XG5cbi8qKlxuICogRXN0YSBjbGFzZSBpbXBsZW1lbnRhIGxhIGludGVyZmF6IEVycm9ySGFuZGxlciB5IHNlIGVuY2FyZ2EgZGUgbWFuZWphciBsb3MgZXJyb3JlcyBxdWUgc2UgcHJvZHVjZW5cbiAqIGVuIGxhIGFwbGljYWNpw7NuLiBQcm9wb3JjaW9uYSB1bmEgZnVuY2nDs24gcGFyYSBleHRyYWVyIGluZm9ybWFjacOzbiBzb2JyZSBlbCBlcnJvciB5IGdlbmVyYXIgdW4gbWVuc2FqZVxuICogZGUgZXJyb3IgcGFyYSBtb3N0cmFyIGFsIHVzdWFyaW8uXG4gKi9cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxufSlcbmV4cG9ydCBjbGFzcyBDb250cm9sRXJyb3Jlc1NlcnZpY2UgaW1wbGVtZW50cyBFcnJvckhhbmRsZXIge1xuICAvKipcbiAgICogQ29uc3RydWN0b3IgZGUgbGEgY2xhc2UgQ29udHJvbEVycm9yZXNTZXJ2aWNlLlxuICAgKi9cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIC8qKlxuICAgKiBFc3RhIGZ1bmNpw7NuIHNlIGVuY2FyZ2EgZGUgbWFuZWphciBsb3MgZXJyb3JlcyBxdWUgc2UgcHJvZHVjZW4gZW4gbGEgYXBsaWNhY2nDs24uXG4gICAqIFNpIGVsIGVycm9yIG5vIGVzIHVuYSBIdHRwRXJyb3JSZXNwb25zZSwgZXh0cmFlIGluZm9ybWFjacOzbiBzb2JyZSBlbCBlcnJvciB5IGdlbmVyYSB1biBtZW5zYWplXG4gICAqIGRlIGVycm9yIHV0aWxpemFuZG8gbGEgZnVuY2nDs24gY3JlYXJNZW5zYWplT2JqZXRvKCkuIFNpIGVzIHVuYSBIdHRwRXJyb3JSZXNwb25zZSwgZXh0cmFlIGluZm9ybWFjacOzblxuICAgKiBzb2JyZSBlbCBlcnJvciB1dGlsaXphbmRvIGxhIGZ1bmNpw7NuIGV4dHJhZXJIdHRwRXJycm8oKSB5IGRldnVlbHZlIHVuIG1lbnNhamUgZGUgZXJyb3IgdmFjw61vLlxuICAgKlxuICAgKiBAcGFyYW0gZXJyb3IgRWwgZXJyb3IgcXVlIHNlIGhhIHByb2R1Y2lkby5cbiAgICogQHJldHVybnMgVW5hIHR1cGxhIHF1ZSBjb250aWVuZSBpbmZvcm1hY2nDs24gc29icmUgZWwgZXJyb3IgeSB1biBtZW5zYWplIGRlIGVycm9yIHBhcmEgbW9zdHJhciBhbCB1c3VhcmlvLlxuICAgKi9cbiAgaGFuZGxlRXJyb3IoZXJyb3I6IEVycm9yKTogW3Vua25vd24sIHVua25vd25dIHtcbiAgICBpZiAoIShlcnJvciBpbnN0YW5jZW9mIEh0dHBFcnJvclJlc3BvbnNlKSkge1xuICAgICAgcmV0dXJuIFt0aGlzLmV4dHJhY3RvckVycm9yVGlwbyhlcnJvciksIGNyZWFyTWVuc2FqZU9iamV0byhlcnJvcildO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gW3RoaXMuZXh0cmFjdG9yRXJyb3JUaXBvKGVycm9yKSwgJyddO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFc3RhIGZ1bmNpw7NuIHNlIGVuY2FyZ2EgZGUgZXh0cmFlciBpbmZvcm1hY2nDs24gc29icmUgZWwgZXJyb3IgZGVwZW5kaWVuZG8gZGVsIHRpcG8gcXVlIHNlYS5cbiAgICogU2kgZWwgZXJyb3IgZXMgdW5hIEh0dHBFcnJvclJlc3BvbnNlLCB1dGlsaXphIGxhIGZ1bmNpw7NuIGV4dHJhZXJIdHRwRXJycm8oKSBwYXJhIGV4dHJhZXIgaW5mb3JtYWNpw7NuXG4gICAqIHNvYnJlIGVsIGVycm9yLiBTaSBlbCBlcnJvciBlcyB1bmEgY2FkZW5hIG8gdW4gb2JqZXRvIGRlIGVycm9yLCBzaW1wbGVtZW50ZSBkZXZ1ZWx2ZSBlbCBlcnJvciB0YWwgY3VhbC5cbiAgICpcbiAgICogQHBhcmFtIGVycm9yQ2FuZGlkYXRlIEVsIGVycm9yIGRlbCBxdWUgc2UgcXVpZXJlIGV4dHJhZXIgaW5mb3JtYWNpw7NuLlxuICAgKiBAcmV0dXJucyBMYSBpbmZvcm1hY2nDs24gZXh0cmHDrWRhIGRlbCBlcnJvci5cbiAgICovXG4gIHByb3RlY3RlZCBleHRyYWN0b3JFcnJvclRpcG8oZXJyb3JDYW5kaWRhdGU6IHVua25vd24pOiB1bmtub3duIHtcbiAgICBjb25zdCBlcnJvciA9IHRyeVRvVW53cmFwWm9uZWpzRXJyb3IoZXJyb3JDYW5kaWRhdGUpO1xuXG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgSHR0cEVycm9yUmVzcG9uc2UpIHtcbiAgICAgIHJldHVybiBleHRyYWVySHR0cEVycnJvKGVycm9yKTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIGVycm9yID09PSAnc3RyaW5nJyB8fCBFc0Vycm9yT0Vycm9yT2JqZXRvKGVycm9yKSkge1xuICAgICAgcmV0dXJuIGVycm9yO1xuICAgIH1cblxuICAgIC8vIE5vIGV4dHJhZSBuYWRhLCBkZXZ1ZWx2ZSBlbCBlcnJvciBwb3IgZGVmZWN0b1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFcnJvcihjb25maWc/OiBFcnJvcik6IENvbnRyb2xFcnJvcmVzU2VydmljZSB7XG4gIHJldHVybiBuZXcgQ29udHJvbEVycm9yZXNTZXJ2aWNlKCk7XG59XG4iXX0=